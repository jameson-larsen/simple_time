<html>
    <head>
        <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">
        <script src="https://code.jquery.com/jquery-3.5.1.min.js"integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.4.0/main.min.js"></script>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@5.4.0/main.min.css">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
            * {
                margin:0;
                padding:0;
                border:none;
                font-family: 'Montserrat', sans-serif;
            }
            html, body {
                height:100%;
                min-height:100%;
            }
            body {
                display:grid;
                grid-template-columns:120px 1fr;
                grid-template-rows:100px 1fr;
            }
            .dashboard-header {
                margin:0;
                padding:0;
                border:0;
                width:100%;
                background-color:#617073;
                grid-row:1;
                grid-column:1 /span 2;
                height:100px;
                z-index:99;
                border-bottom:1px solid #a7c6c9;
                position:relative;
            }
            .dashboard-sidebar {
                height:100%;
                background-color:#617073;
                grid-column:1;
                grid-row:1 /span 2;
                padding-top:130px;
                text-align:center;
            }
            .dashboard-content {
                grid-row:2;
                grid-column:2;
                border:25px solid #a7c6c9;
                height:100%;
                width:100%;
                background-color:#f2f2f2;
            }
            .logo {
                width:200px;
                height:auto;
                position:absolute;
                top:15px;
                left:8px;
            }
            .status {
                color:white;
            }
            .log-out-btn {
                position:absolute;
                margin:0;
                padding:0;
                top:50%;
                transform:translateY(-50%);
                right:12px;
                width:100px;
                height:40px;
                background-color:#6EC2CB;
                color:white;
                border:none;
                font-size:16px;
            }
            .dashboard-content {
                display:grid;
                grid-template-rows:1fr;
                grid-template-columns:1fr 3fr;
            }
            .user-info {
                grid-column:1;
                height:100%;
                border-right:1px solid #6EC2CB;
                text-align:center;
                padding-top:35px;
            }
            .user-info p {
                text-align:left;
                padding-left:35px;
                margin-bottom:18px;
            }
            .user-info h2, .user-info img, .user-info h3 {
                margin-bottom:30px;
            }
            .main-content {
                grid-column:2;
                height:100%;
            }
            .sidebar-btn {
                background-color:rgba(0,0,0,0);
                margin-top:30px;
            }
            .sidebar-btn img {
                width:55px;
                margin-bottom:5px;
                cursor:pointer;
            }
            .sidebar-btn p {
                color:white;
            }
            .fc-timegrid-slots tr {
                height: 45px;
            }
        </style>
    </head>
    <body>
        <div class="dashboard-header"">
            <img src="https://simple-time-assets.s3-us-west-2.amazonaws.com/simple-time-logo.png" alt="" class="logo">
            <%= button_to "LOG OUT", destroy_user_session_path, method: :delete, class: "log-out-btn" %>
        </div>
        <div class="dashboard-sidebar">
            <% if current_user.is_in? %>
                <p class="status">STATUS: IN</p>
                <%= button_to clock_out_path, method: :patch, class: :"sidebar-btn" do %>
                    <%=image_tag("https://simple-time-assets.s3-us-west-2.amazonaws.com/clock.png") %>
                    <p>Clock Out</p>
                <% end %>
            <% else %>
                <p class="status">STATUS: OUT</p>
                <%= button_to clock_in_path, method: :patch, class: :"sidebar-btn" do %>
                    <%=image_tag("https://simple-time-assets.s3-us-west-2.amazonaws.com/clock.png") %>
                    <p>Clock In</p>
                <% end %>
            <% end %>
        </div>
        <div class="dashboard-content">
            <div class="user-info">
                <h2>Welcome, <%= current_user.f_name %></h2>
                <img src="https://simple-time-assets.s3-us-west-2.amazonaws.com/profile.png">
                <h3>Your Profile</h3>
                <p>Name: <%= current_user.f_name + " " + current_user.l_name %></p>
                <p>Email: <%= current_user.email %></p>
                <p>Company: <%= @company.name %></p>
                <p>Role: <%= current_user.user_role %></p>
                <p>Last Punch: <span id="last-user-punch"></span></p>
            </div>
            <div class="main-content">
                <%= yield %>
            </div>
        </div>
        <%= content_tag :div, class: "user_punches", data: {punches: @punches} do %>
        <% end %>
        <%= content_tag :div, class: "user_info", data: {last_time: current_user.last_punch_date} do %>
        <% end %>
    </body>
    <script>
        $(function() {
            var t = $('.user_info').data('last-time')
            var options = {month: 'numeric', day: 'numeric', hour: 'numeric', minute: '2-digit' };
            var d = new Date(t * 1000).toLocaleString(undefined, options)
            d = d.replace (/,/g, "");
            document.getElementById('last-user-punch').innerText = d
        })
    </script>
</html>